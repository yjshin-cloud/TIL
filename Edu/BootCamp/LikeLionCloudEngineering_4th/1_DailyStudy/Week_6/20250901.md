# Spring Boot ìƒíƒœ ê´€ë¦¬ & ë³´ì•ˆ ì¢…í•© ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ìƒíƒœ ê´€ë¦¬ ê°œìš”](#ìƒíƒœ-ê´€ë¦¬-ê°œìš”)
2. [Modelì„ ì´ìš©í•œ ë°ì´í„° ì „ë‹¬](#modelì„-ì´ìš©í•œ-ë°ì´í„°-ì „ë‹¬)
3. [RedirectAttributesë¥¼ ì´ìš©í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°ì´í„° ì „ë‹¬](#redirectattributesë¥¼-ì´ìš©í•œ-ë¦¬ë‹¤ì´ë ‰íŠ¸-ë°ì´í„°-ì „ë‹¬)
4. [Sessionì„ ì´ìš©í•œ ìƒíƒœ ê´€ë¦¬](#sessionì„-ì´ìš©í•œ-ìƒíƒœ-ê´€ë¦¬)
5. [Cookieë¥¼ ì´ìš©í•œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬](#cookieë¥¼-ì´ìš©í•œ-í´ë¼ì´ì–¸íŠ¸-ìƒíƒœ-ê´€ë¦¬)
6. [Spring Security ê¸°ë³¸ ì„¤ì •](#spring-security-ê¸°ë³¸-ì„¤ì •)
7. [ì˜ˆì™¸ ì²˜ë¦¬](#ì˜ˆì™¸-ì²˜ë¦¬)
8. [í˜„ì—…ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ](#í˜„ì—…ì—ì„œ-ì£¼ë¡œ-ì‚¬ìš©í•˜ëŠ”-ê¸°ìˆ )

---

## ìƒíƒœ ê´€ë¦¬ ê°œìš”

Spring Bootì—ì„œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ì£¼ìš” ë°©ë²•ë“¤ì„ ì‹œê°í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```mermaid
graph TB
    A[í´ë¼ì´ì–¸íŠ¸ ìš”ì²­] --> B[Spring Boot Controller]
    B --> C{ìƒíƒœ ê´€ë¦¬ ë°©ë²• ì„ íƒ}
    
    C -->|ì¼íšŒì„± ë°ì´í„° ì „ë‹¬| D[Model]
    C -->|ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œ ë°ì´í„° ì „ë‹¬| E[RedirectAttributes]
    C -->|ì—¬ëŸ¬ ìš”ì²­ ê°„ ìƒíƒœ ìœ ì§€| F[HttpSession]
    C -->|í´ë¼ì´ì–¸íŠ¸ ì €ì¥| G[Cookie]
    
    D --> H[View ë Œë”ë§]
    E --> I[ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ Flash Attribute]
    F --> J[ì„œë²„ ë©”ëª¨ë¦¬ ì €ì¥]
    G --> K[ë¸Œë¼ìš°ì € ì €ì¥]
    
    H --> L[ì‘ë‹µ ì „ì†¡]
    I --> L
    J --> L
    K --> L
    
    style D fill:#e1f5fe
    style E fill:#f3e5f5
    style F fill:#e8f5e8
    style G fill:#fff3e0
```

---

## Modelì„ ì´ìš©í•œ ë°ì´í„° ì „ë‹¬

### ê°œë…
- Controllerì—ì„œ Viewë¡œ **ì¼íšŒì„± ë°ì´í„° ì „ë‹¬**ì— ì‚¬ìš©
- Forward ë°©ì‹ì—ì„œë§Œ ë™ì‘ (ê°™ì€ ìš”ì²­ ë‚´ì—ì„œ)
- HttpServletRequestì˜ Attributeë¥¼ ë˜í•‘í•œ ê°ì²´

### ì½”ë“œ ì˜ˆì œ

```java
// controller/ExampleController.java
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

@Controller  // ì´ í´ë˜ìŠ¤ê°€ Spring MVC Controllerì„ì„ ì„ ì–¸
public class ExampleController {
    
    @GetMapping("/hello")  // GET ìš”ì²­ /hello URLì„ ì´ ë©”ì„œë“œê°€ ì²˜ë¦¬
    public String hello(Model model) {
        // Model ê°ì²´ë¥¼ í†µí•´ Viewì— ì „ë‹¬í•  ë°ì´í„°ë¥¼ ì„¤ì •
        
        // "message"ë¼ëŠ” í‚¤ë¡œ "Hello, Thymeleaf!" ê°’ì„ ëª¨ë¸ì— ì¶”ê°€
        // Viewì—ì„œ ${message}ë¡œ ì ‘ê·¼ ê°€ëŠ¥
        model.addAttribute("message", "Hello, Thymeleaf!");
        
        // "userName"ì´ë¼ëŠ” í‚¤ë¡œ "Gemini" ê°’ì„ ëª¨ë¸ì— ì¶”ê°€  
        // Viewì—ì„œ ${userName}ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥
        model.addAttribute("userName", "Gemini");
        
        // templates/hello.html í…œí”Œë¦¿ì„ ì°¾ì•„ì„œ ë Œë”ë§í•˜ë¼ê³  ì§€ì‹œ
        // Spring BootëŠ” ê¸°ë³¸ì ìœ¼ë¡œ src/main/resources/templates/ ê²½ë¡œì—ì„œ í…œí”Œë¦¿ì„ ì°¾ìŒ
        return "hello";
    }
}
```

```html
<!-- templates/hello.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">  <!-- Thymeleaf ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„ ì–¸ -->
<head>
    <title>Hello</title>
</head>
<body>
    <!-- th:textëŠ” Thymeleaf ë¬¸ë²•ìœ¼ë¡œ ${message} ê°’ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ì¹˜í™˜ -->
    <!-- ë§Œì•½ messageê°€ ì—†ìœ¼ë©´ "ê¸°ë³¸ ë©”ì‹œì§€"ê°€ í‘œì‹œë¨ -->
    <h1 th:text="${message}">ê¸°ë³¸ ë©”ì‹œì§€</h1>
    
    <!-- span íƒœê·¸ ì•ˆì˜ í…ìŠ¤íŠ¸ë¥¼ ${userName} ê°’ìœ¼ë¡œ ì¹˜í™˜ -->
    <!-- userNameì´ ì—†ìœ¼ë©´ "Guest"ê°€ í‘œì‹œë¨ -->
    <p>Welcome, <span th:text="${userName}">Guest</span>!</p>
</body>
</html>
```

### ë™ì‘ íë¦„
```mermaid
sequenceDiagram
    participant C as Client
    participant SC as Spring Controller
    participant M as Model
    participant V as View Engine
    
    C->>SC: GET /hello
    SC->>M: addAttribute("message", "Hello!")
    SC->>M: addAttribute("userName", "Gemini")
    SC->>V: return "hello" (í…œí”Œë¦¿ ì´ë¦„)
    V->>M: ëª¨ë¸ ë°ì´í„° ì¡°íšŒ
    V->>C: HTML ì‘ë‹µ (ë°ì´í„° í¬í•¨)
```

---

## RedirectAttributesë¥¼ ì´ìš©í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°ì´í„° ì „ë‹¬

### ê°œë…
- **Redirect ì‹œ 1íšŒì„± ë°ì´í„° ì „ë‹¬**ì— ì‚¬ìš©
- Flash Attribute: ì„¸ì…˜ì„ ì„ì‹œë¡œ ì‚¬ìš©í•˜ì—¬ ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ í•œ ë²ˆë§Œ ì‚¬ìš© ê°€ëŠ¥
- PRG(Post-Redirect-Get) íŒ¨í„´ì—ì„œ ì£¼ë¡œ ì‚¬ìš©

### ì½”ë“œ ì˜ˆì œ

```java
// controller/ExampleController.java
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@Controller
public class ExampleController {
    
    @PostMapping("/save-data")  // POST ìš”ì²­ ì²˜ë¦¬ (í¼ ì œì¶œ ë“±)
    public String saveData(RedirectAttributes redirectAttributes) {
        
        // ì‹¤ì œë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë¡œì§ì´ ë“¤ì–´ê°
        // ì—¬ê¸°ì„œëŠ” ì˜ˆì œë¥¼ ìœ„í•´ ì„±ê³µí–ˆë‹¤ê³  ê°€ì •
        boolean success = true;
        
        if (success) {
            // CSRF ë³´í˜¸ ì„¤ì • (ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë¨)
            .csrf(csrf -> csrf
                // REST API ê²½ë¡œëŠ” CSRF ë³´í˜¸ ë¹„í™œì„±í™” (ì£¼ë¡œ JWT ì‚¬ìš© ì‹œ)
                .ignoringRequestMatchers("/api/**")
            );
        
        return http.build();
    }
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        // BCrypt í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
        // ê°™ì€ ë¹„ë°€ë²ˆí˜¸ë¼ë„ ë§¤ë²ˆ ë‹¤ë¥¸ í•´ì‹œê°’ ìƒì„± (ì†”íŠ¸ ì‚¬ìš©)
        return new BCryptPasswordEncoder();
    }
    
    @Bean
    public UserDetailsService userDetailsService() {
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ì €ì¥ì†Œ (í…ŒìŠ¤íŠ¸ìš©)
        // ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ í•„ìš”
        
        UserDetails user = User.builder()
                .username("user")  // ì‚¬ìš©ìëª…
                .password(passwordEncoder().encode("password"))  // ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸
                .roles("USER")  // ì—­í•  ì„¤ì • (ROLE_USERë¡œ ì €ì¥ë¨)
                .build();
        
        UserDetails admin = User.builder()
                .username("admin")
                .password(passwordEncoder().encode("admin123"))
                .roles("USER", "ADMIN")  // ì—¬ëŸ¬ ì—­í•  ì„¤ì • ê°€ëŠ¥
                .build();
        
        // ë©”ëª¨ë¦¬ì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
        return new InMemoryUserDetailsManager(user, admin);
    }
}
```

### ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬

```java
// controller/AuthController.java
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class AuthController {
    
    @GetMapping("/login")
    public String login(
            @RequestParam(value = "error", required = false) String error,  // ë¡œê·¸ì¸ ì‹¤íŒ¨ íŒŒë¼ë¯¸í„°
            @RequestParam(value = "logout", required = false) String logout,  // ë¡œê·¸ì•„ì›ƒ íŒŒë¼ë¯¸í„°
            Model model) {
        
        // ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ ì„¤ì •
        if (error != null) {
            model.addAttribute("errorMessage", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }
        
        // ë¡œê·¸ì•„ì›ƒ ì„±ê³µ ì‹œ ë©”ì‹œì§€ ì„¤ì •
        if (logout != null) {
            model.addAttribute("logoutMessage", "ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.");
        }
        
        return "login";  // templates/login.html ë Œë”ë§
    }
    
    @GetMapping("/dashboard")
    public String dashboard(Model model) {
        // ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ëŒ€ì‹œë³´ë“œ
        model.addAttribute("message", "ë¡œê·¸ì¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤!");
        return "dashboard";
    }
}
```

```html
<!-- templates/login.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ë¡œê·¸ì¸</title>
    <style>
        .login-container { max-width: 400px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; }
        .form-group { margin: 15px 0; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #ccc; }
        .btn-primary { background: #007bff; color: white; padding: 10px 20px; border: none; width: 100%; }
        .alert { padding: 10px; margin: 10px 0; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .alert-success { background: #d4edda; color: #155724; }
    </style>
</head>
<body>
    <div class="login-container">
        <h2>ë¡œê·¸ì¸</h2>
        
        <!-- ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ -->
        <div th:if="${errorMessage}" class="alert alert-error">
            <p th:text="${errorMessage}"></p>
        </div>
        
        <!-- ë¡œê·¸ì•„ì›ƒ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ -->
        <div th:if="${logoutMessage}" class="alert alert-success">
            <p th:text="${logoutMessage}"></p>
        </div>
        
        <!-- Spring Securityê°€ ì²˜ë¦¬í•˜ëŠ” ë¡œê·¸ì¸ í¼ -->
        <!-- action="/login"ê³¼ method="post"ëŠ” Spring Security ê¸°ë³¸ ì„¤ì • -->
        <form th:action="@{/login}" method="post">
            
            <div class="form-group">
                <label for="username">ì‚¬ìš©ìëª…:</label>
                <!-- name="username"ì€ Spring Security ê¸°ë³¸ íŒŒë¼ë¯¸í„°ëª… -->
                <input type="text" id="username" name="username" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸:</label>
                <!-- name="password"ëŠ” Spring Security ê¸°ë³¸ íŒŒë¼ë¯¸í„°ëª… -->
                <input type="password" id="password" name="password" class="form-control" required>
            </div>
            
            <!-- CSRF í† í° ìë™ ì¶”ê°€ (Thymeleafê°€ ìë™ ì²˜ë¦¬) -->
            <button type="submit" class="btn-primary">ë¡œê·¸ì¸</button>
        </form>
        
        <div style="margin-top: 20px; font-size: 12px; color: #666;">
            <p>í…ŒìŠ¤íŠ¸ ê³„ì •:</p>
            <p>ì¼ë°˜ ì‚¬ìš©ì - user/password</p>
            <p>ê´€ë¦¬ì - admin/admin123</p>
        </div>
    </div>
</body>
</html>
```

### Spring Security ì¸ì¦ íë¦„
```mermaid
sequenceDiagram
    participant C as Client
    participant SF as Security Filter
    participant AM as Authentication Manager
    participant UDS as UserDetailsService
    participant SC as Spring Controller
    
    C->>SF: POST /login (username, password)
    SF->>AM: ì¸ì¦ ìš”ì²­
    AM->>UDS: ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
    UDS->>AM: UserDetails ë°˜í™˜
    AM->>AM: ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
    AM->>SF: ì¸ì¦ ê²°ê³¼
    alt ì¸ì¦ ì„±ê³µ
        SF->>SC: ë³´í˜¸ëœ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ í—ˆìš©
        SC->>C: ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
    else ì¸ì¦ ì‹¤íŒ¨
        SF->>C: ë¡œê·¸ì¸ í˜ì´ì§€ (ì—ëŸ¬ ë©”ì‹œì§€)
    end
```

---

## ì˜ˆì™¸ ì²˜ë¦¬

### ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬ê¸°

```java
// exception/GlobalExceptionHandler.java
package com.example.demo.exception;

import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@ControllerAdvice  // ëª¨ë“  Controllerì—ì„œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸ë¥¼ ì²˜ë¦¬
public class GlobalExceptionHandler {
    
    @ExceptionHandler(IllegalArgumentException.class)  // IllegalArgumentException ì²˜ë¦¬
    public String handleIllegalArgumentException(
            IllegalArgumentException e, 
            Model model) {
        
        // ì˜ˆì™¸ ë©”ì‹œì§€ë¥¼ Modelì— ì¶”ê°€
        model.addAttribute("errorMessage", e.getMessage());
        model.addAttribute("errorType", "ì…ë ¥ ì˜¤ë¥˜");
        
        // ì—ëŸ¬ í˜ì´ì§€ ë°˜í™˜
        return "error";
    }
    
    @ExceptionHandler(RuntimeException.class)  // ëŸ°íƒ€ì„ ì˜ˆì™¸ ì²˜ë¦¬
    public String handleRuntimeException(
            RuntimeException e, 
            RedirectAttributes redirectAttributes) {
        
        // ì˜ˆì™¸ ë°œìƒ ì‹œ Flash Attributeë¡œ ì—ëŸ¬ ë©”ì‹œì§€ ì „ë‹¬
        redirectAttributes.addFlashAttribute("errorMessage", 
            "ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.getMessage());
        
        // ì´ì „ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
        return "redirect:/";
    }
    
    @ExceptionHandler(Exception.class)  // ëª¨ë“  ì˜ˆì™¸ì˜ ìµœì¢… ì²˜ë¦¬
    public String handleGenericException(Exception e, Model model) {
        
        // ìƒì„¸í•œ ì—ëŸ¬ ì •ë³´ë¥¼ Modelì— ì¶”ê°€
        model.addAttribute("errorMessage", "ì‹œìŠ¤í…œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        model.addAttribute("errorDetails", e.getMessage());
        model.addAttribute("errorType", "ì‹œìŠ¤í…œ ì˜¤ë¥˜");
        
        return "error";
    }
}
```

### ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤

```java
// exception/CustomExceptions.java
package com.example.demo.exception;

// ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸
public class UserNotFoundException extends RuntimeException {
    public UserNotFoundException(String message) {
        super(message);  // ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ìƒì„±ì í˜¸ì¶œ
    }
    
    public UserNotFoundException(String message, Throwable cause) {
        super(message, cause);  // ì›ì¸ ì˜ˆì™¸ê¹Œì§€ í•¨ê»˜ ì „ë‹¬
    }
}

// ê¶Œí•œì´ ì—†ì„ ë•Œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸
public class UnauthorizedException extends RuntimeException {
    public UnauthorizedException(String message) {
        super(message);
    }
}

// ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨ ì‹œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸
public class ValidationException extends RuntimeException {
    private final String field;  // ì–´ë–¤ í•„ë“œì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆëŠ”ì§€
    
    public ValidationException(String field, String message) {
        super(message);
        this.field = field;
    }
    
    public String getField() {
        return field;
    }
}
```

```html
<!-- templates/error.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ì˜¤ë¥˜ ë°œìƒ</title>
    <style>
        .error-container { max-width: 600px; margin: 50px auto; padding: 20px; }
        .error-header { color: #dc3545; border-bottom: 2px solid #dc3545; padding-bottom: 10px; }
        .error-content { background: #f8d7da; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .error-details { background: #f5f5f5; padding: 10px; margin: 10px 0; font-family: monospace; }
        .btn-home { background: #007bff; color: white; padding: 10px 20px; text-decoration: none; }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-header">
            <h1>âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h1>
        </div>
        
        <div class="error-content">
            <!-- ì—ëŸ¬ íƒ€ì… í‘œì‹œ -->
            <h3 th:text="${errorType ?: 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}">ì˜¤ë¥˜ íƒ€ì…</h3>
            
            <!-- ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ -->
            <p th:text="${errorMessage ?: 'ì²˜ë¦¬ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}">ì—ëŸ¬ ë©”ì‹œì§€</p>
        </div>
        
        <!-- ìƒì„¸ ì—ëŸ¬ ì •ë³´ê°€ ìˆì„ ë•Œë§Œ í‘œì‹œ -->
        <div th:if="${errorDetails}" class="error-details">
            <h4>ìƒì„¸ ì •ë³´:</h4>
            <pre th:text="${errorDetails}"></pre>
        </div>
        
        <div>
            <a href="/" class="btn-home">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
            <a href="javascript:history.back()" class="btn-home" style="background: #6c757d;">ì´ì „ í˜ì´ì§€</a>
        </div>
    </div>
</body>
</html>
```

---

## ì‹¤ë¬´ ì ìš© ì˜ˆì œ: ì‡¼í•‘ëª° ì¥ë°”êµ¬ë‹ˆ

### ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„

```java
// controller/ShoppingCartController.java
package com.example.demo.controller;

import jakarta.servlet.http.HttpSession;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import java.util.ArrayList;
import java.util.List;

@Controller
public class ShoppingCartController {
    
    // ìƒí’ˆ ì •ë³´ë¥¼ ë‹´ëŠ” ê°„ë‹¨í•œ í´ë˜ìŠ¤
    public static class CartItem {
        private String productName;  // ìƒí’ˆëª…
        private int quantity;        // ìˆ˜ëŸ‰
        private double price;        // ê°€ê²©
        
        // ìƒì„±ì
        public CartItem(String productName, int quantity, double price) {
            this.productName = productName;
            this.quantity = quantity;
            this.price = price;
        }
        
        // Getter ë©”ì„œë“œë“¤ (Thymeleafì—ì„œ ì ‘ê·¼í•˜ê¸° ìœ„í•´ í•„ìš”)
        public String getProductName() { return productName; }
        public int getQuantity() { return quantity; }
        public double getPrice() { return price; }
        public double getTotalPrice() { return quantity * price; }  // ì´ ê°€ê²© ê³„ì‚°
        
        // ìˆ˜ëŸ‰ ì¦ê°€ ë©”ì„œë“œ
        public void increaseQuantity() { this.quantity++; }
    }
    
    @GetMapping("/shop")
    public String showShop() {
        // ìƒí’ˆ ëª©ë¡ í˜ì´ì§€ í‘œì‹œ
        return "shop";
    }
    
    @PostMapping("/cart/add")
    public String addToCart(
            @RequestParam String productName,  // ìƒí’ˆëª…
            @RequestParam int quantity,        // ìˆ˜ëŸ‰
            @RequestParam double price,        // ê°€ê²©
            HttpSession session,               // ì„¸ì…˜ ê°ì²´
            RedirectAttributes redirectAttributes) {
        
        try {
            // ì„¸ì…˜ì—ì„œ ì¥ë°”êµ¬ë‹ˆ ì¡°íšŒ (ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±)
            @SuppressWarnings("unchecked")
            List<CartItem> cart = (List<CartItem>) session.getAttribute("cart");
            
            if (cart == null) {
                cart = new ArrayList<>();  // ì²« ìƒí’ˆ ì¶”ê°€ ì‹œ ìƒˆ ì¥ë°”êµ¬ë‹ˆ ìƒì„±
            }
            
            // ì´ë¯¸ ê°™ì€ ìƒí’ˆì´ ì¥ë°”êµ¬ë‹ˆì— ìˆëŠ”ì§€ í™•ì¸
            boolean found = false;
            for (CartItem item : cart) {
                if (item.getProductName().equals(productName)) {
                    item.increaseQuantity();  // ì´ë¯¸ ìˆìœ¼ë©´ ìˆ˜ëŸ‰ë§Œ ì¦ê°€
                    found = true;
                    break;
                }
            }
            
            // ìƒˆë¡œìš´ ìƒí’ˆì´ë©´ ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€
            if (!found) {
                cart.add(new CartItem(productName, quantity, price));
            }
            
            // ì—…ë°ì´íŠ¸ëœ ì¥ë°”êµ¬ë‹ˆë¥¼ ì„¸ì…˜ì— ë‹¤ì‹œ ì €ì¥
            session.setAttribute("cart", cart);
            
            // ì„±ê³µ ë©”ì‹œì§€ Flash Attributeë¡œ ì „ë‹¬
            redirectAttributes.addFlashAttribute("successMessage", 
                productName + "ì´(ê°€) ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!");
            
        } catch (Exception e) {
            // ì—ëŸ¬ ë°œìƒ ì‹œ Flash Attributeë¡œ ì—ëŸ¬ ë©”ì‹œì§€ ì „ë‹¬
            redirectAttributes.addFlashAttribute("errorMessage", 
                "ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
        
        return "redirect:/cart";
    }
    
    @GetMapping("/cart")
    public String showCart(HttpSession session, Model model) {
        
        // ì„¸ì…˜ì—ì„œ ì¥ë°”êµ¬ë‹ˆ ì¡°íšŒ
        @SuppressWarnings("unchecked")
        List<CartItem> cart = (List<CartItem>) session.getAttribute("cart");
        
        if (cart == null) {
            cart = new ArrayList<>();  // ë¹ˆ ì¥ë°”êµ¬ë‹ˆë¡œ ì´ˆê¸°í™”
        }
        
        // ì´ ê°€ê²© ê³„ì‚°
        double totalAmount = cart.stream()
                .mapToDouble(CartItem::getTotalPrice)  // ê° ì•„ì´í…œì˜ ì´ ê°€ê²©
                .sum();  // ëª¨ë“  ì•„ì´í…œì˜ ê°€ê²© í•©ê³„
        
        // Modelì— ë°ì´í„° ì¶”ê°€í•˜ì—¬ Viewë¡œ ì „ë‹¬
        model.addAttribute("cartItems", cart);
        model.addAttribute("totalAmount", totalAmount);
        model.addAttribute("itemCount", cart.size());
        
        return "cart";
    }
    
    @PostMapping("/cart/clear")
    public String clearCart(
            HttpSession session, 
            RedirectAttributes redirectAttributes) {
        
        // ì„¸ì…˜ì—ì„œ ì¥ë°”êµ¬ë‹ˆ ì œê±°
        session.removeAttribute("cart");
        
        // ì„±ê³µ ë©”ì‹œì§€ ì „ë‹¬
        redirectAttributes.addFlashAttribute("successMessage", "ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.");
        
        return "redirect:/cart";
    }
}
```

### ì¥ë°”êµ¬ë‹ˆ í˜ì´ì§€

```html
<!-- templates/cart.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ì¥ë°”êµ¬ë‹ˆ</title>
    <style>
        .cart-container { max-width: 800px; margin: 20px auto; padding: 20px; }
        .cart-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .cart-table th, .cart-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        .cart-table th { background: #f5f5f5; }
        .total-section { background: #e9ecef; padding: 15px; margin: 20px 0; }
        .btn { padding: 10px 20px; margin: 5px; text-decoration: none; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .alert { padding: 10px; margin: 10px 0; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="cart-container">
        <h1>ğŸ›’ ì¥ë°”êµ¬ë‹ˆ</h1>
        
        <!-- Flash Attribute ë©”ì‹œì§€ í‘œì‹œ -->
        <div th:if="${successMessage}" class="alert alert-success">
            <p th:text="${successMessage}"></p>
        </div>
        
        <div th:if="${errorMessage}" class="alert alert-error">
            <p th:text="${errorMessage}"></p>
        </div>
        
        <!-- ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆì§€ ì•Šì„ ë•Œë§Œ í…Œì´ë¸” í‘œì‹œ -->
        <div th:if="${cartItems != null and #lists.size(cartItems) > 0}">
            <table class="cart-table">
                <thead>
                    <tr>
                        <th>ìƒí’ˆëª…</th>
                        <th>ê°€ê²©</th>
                        <th>ìˆ˜ëŸ‰</th>
                        <th>ì´ ê°€ê²©</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Thymeleaf ë°˜ë³µë¬¸: cartItemsì˜ ê° í•­ëª©ì— ëŒ€í•´ ë°˜ë³µ -->
                    <tr th:each="item : ${cartItems}">
                        <td th:text="${item.productName}">ìƒí’ˆëª…</td>
                        <td th:text="${#numbers.formatDecimal(item.price, 0, 2)} + 'ì›'">ê°€ê²©</td>
                        <td th:text="${item.quantity} + 'ê°œ'">ìˆ˜ëŸ‰</td>
                        <td th:text="${#numbers.formatDecimal(item.totalPrice, 0, 2)} + 'ì›'">ì´ ê°€ê²©</td>
                    </tr>
                </tbody>
            </table>
            
            <!-- ì£¼ë¬¸ ìš”ì•½ -->
            <div class="total-section">
                <h3>ì£¼ë¬¸ ìš”ì•½</h3>
                <p>ì´ ìƒí’ˆ ìˆ˜: <strong th:text="${itemCount}">0</strong>ê°œ</p>
                <p>ì´ ê²°ì œ ê¸ˆì•¡: <strong th:text="${#numbers.formatDecimal(totalAmount, 0, 2)} + 'ì›'">0ì›</strong></p>
            </div>
            
            <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
            <div>
                <form th:action="@{/cart/clear}" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-danger" 
                            onclick="return confirm('ì¥ë°”êµ¬ë‹ˆë¥¼ ëª¨ë‘ ë¹„ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')">
                        ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
                    </button>
                </form>
                <a href="/shop" class="btn btn-primary">ê³„ì† ì‡¼í•‘í•˜ê¸°</a>
            </div>
        </div>
        
        <!-- ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆì„ ë•Œ -->
        <div th:if="${cartItems == null or #lists.size(cartItems) == 0}">
            <p>ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.</p>
            <a href="/shop" class="btn btn-primary">ì‡¼í•‘í•˜ëŸ¬ ê°€ê¸°</a>
        </div>
    </div>
</body>
</html>
```

---

## ìƒíƒœ ê´€ë¦¬ ë°©ë²• ë¹„êµ

```mermaid
graph TB
    subgraph "ë°ì´í„° ì „ë‹¬ ë°©ë²• ë¹„êµ"
        A[Model] --> A1[Forwardë§Œ ê°€ëŠ¥]
        A1 --> A2[ìš”ì²­ ë²”ìœ„]
        A2 --> A3[ì„œë²„ ë©”ëª¨ë¦¬]
        
        B[RedirectAttributes] --> B1[Redirect ì‹œ ì‚¬ìš©]
        B1 --> B2[í•œ ë²ˆë§Œ ì‚¬ìš©]
        B2 --> B3[ì„¸ì…˜ ì„ì‹œ ì‚¬ìš©]
        
        C[HttpSession] --> C1[ì—¬ëŸ¬ ìš”ì²­ ê°„ ìœ ì§€]
        C1 --> C2[ì‚¬ìš©ì ë¡œê·¸ì•„ì›ƒê¹Œì§€]
        C2 --> C3[ì„œë²„ ë©”ëª¨ë¦¬]
        
        D[Cookie] --> D1[í´ë¼ì´ì–¸íŠ¸ ì €ì¥]
        D1 --> D2[ë§Œë£Œì¼ê¹Œì§€ ìœ ì§€]
        D2 --> D3[ë¸Œë¼ìš°ì € ì €ì¥]
    end
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
```

| ë°©ë²• | ì €ì¥ ìœ„ì¹˜ | ìƒëª… ì£¼ê¸° | ìš©ëŸ‰ ì œí•œ | ë³´ì•ˆì„± | ì‚¬ìš© ì‹œê¸° |
|------|-----------|-----------|-----------|--------|-----------|
| **Model** | ì„œë²„ ë©”ëª¨ë¦¬ | í•˜ë‚˜ì˜ ìš”ì²­ | ì œí•œ ì—†ìŒ | ë†’ìŒ | Controller â†’ View ë°ì´í„° ì „ë‹¬ |
| **RedirectAttributes** | ì„¸ì…˜ (ì„ì‹œ) | ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ 1íšŒ | ì œí•œ ì—†ìŒ | ë†’ìŒ | PRG íŒ¨í„´, ìƒíƒœ ë©”ì‹œì§€ ì „ë‹¬ |
| **HttpSession** | ì„œë²„ ë©”ëª¨ë¦¬ | ì„¸ì…˜ ìœ ì§€ ê¸°ê°„ | ì œí•œ ì—†ìŒ | ë†’ìŒ | ë¡œê·¸ì¸ ìƒíƒœ, ì¥ë°”êµ¬ë‹ˆ ë“± |
| **Cookie** | í´ë¼ì´ì–¸íŠ¸ | ì„¤ì •ëœ ë§Œë£Œì¼ê¹Œì§€ | 4KB | ë‚®ìŒ | ì‚¬ìš©ì ì„¤ì •, ì„ì‹œ ë°ì´í„° |

---

## JWT ê¸°ë°˜ ì¸ì¦ (í˜„ì—… í‘œì¤€)

### JWT ì„¤ì •

```java
// config/JwtConfig.java
package com.example.demo.config;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.security.Keys;
import org.springframework.stereotype.Component;

import java.security.Key;
import java.util.Date;

@Component  // Spring Beanìœ¼ë¡œ ë“±ë¡
public class JwtUtil {
    
    // JWT ì„œëª…ì— ì‚¬ìš©í•  ë¹„ë°€í‚¤ (ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜ë‚˜ ì„¤ì •íŒŒì¼ì—ì„œ ê´€ë¦¬)
    private final Key secretKey = Keys.secretKeyFor(SignatureAlgorithm.HS256);
    
    // JWT ë§Œë£Œ ì‹œê°„ (24ì‹œê°„)
    private final long EXPIRATION_TIME = 1000 * 60 * 60 * 24;
    
    // JWT í† í° ìƒì„±
    public String generateToken(String username) {
        Date now = new Date();  // í˜„ì¬ ì‹œê°„
        Date expiryDate = new Date(now.getTime() + EXPIRATION_TIME);  // ë§Œë£Œ ì‹œê°„
        
        return Jwts.builder()
                .setSubject(username)  // í† í°ì˜ ì£¼ì²´ (ì‚¬ìš©ìëª…)
                .setIssuedAt(now)      // í† í° ë°œê¸‰ ì‹œê°„
                .setExpiration(expiryDate)  // í† í° ë§Œë£Œ ì‹œê°„
                .signWith(secretKey)   // ë¹„ë°€í‚¤ë¡œ ì„œëª…
                .compact();            // ë¬¸ìì—´ë¡œ ì§ë ¬í™”
    }
    
    // JWT í† í°ì—ì„œ ì‚¬ìš©ìëª… ì¶”ì¶œ
    public String getUsernameFromToken(String token) {
        Claims claims = Jwts.parserBuilder()
                .setSigningKey(secretKey)  // ì„œëª… ê²€ì¦ìš© í‚¤ ì„¤ì •
                .build()
                .parseClaimsJws(token)     // í† í° íŒŒì‹± ë° ê²€ì¦
                .getBody();                // Claims ì¶”ì¶œ
        
        return claims.getSubject();  // ì‚¬ìš©ìëª… ë°˜í™˜
    }
    
    // JWT í† í° ìœ íš¨ì„± ê²€ì¦
    public boolean validateToken(String token) {
        try {
            Jwts.parserBuilder()
                    .setSigningKey(secretKey)
                    .build()
                    .parseClaimsJws(token);
            return true;  // íŒŒì‹± ì„±ê³µí•˜ë©´ ìœ íš¨í•œ í† í°
        } catch (Exception e) {
            return false;  // ì˜ˆì™¸ ë°œìƒí•˜ë©´ ìœ íš¨í•˜ì§€ ì•Šì€ í† í°
        }
    }
}
```

### REST API ì»¨íŠ¸ë¡¤ëŸ¬

```java
// controller/ApiController.java
package com.example.demo.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

@RestController  // JSON ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ” Controller
@RequestMapping("/api")  // ëª¨ë“  ë©”ì„œë“œì— /api ì ‘ë‘ì‚¬ ì¶”ê°€
public class ApiController {
    
    @Autowired
    private JwtUtil jwtUtil;  // JWT ìœ í‹¸ë¦¬í‹° ì£¼ì…
    
    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestBody Map<String, String> loginData) {
        
        String username = loginData.get("username");  // ìš”ì²­ì—ì„œ ì‚¬ìš©ìëª… ì¶”ì¶œ
        String password = loginData.get("password");  // ìš”ì²­ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì¶”ì¶œ
        
        // ì‹¤ì œë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ì ì¸ì¦
        // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ í•˜ë“œì½”ë”©ëœ ì¸ì¦
        if ("user".equals(username) && "password".equals(password)) {
            
            // ì¸ì¦ ì„±ê³µ ì‹œ JWT í† í° ìƒì„±
            String token = jwtUtil.generateToken(username);
            
            // JSON ì‘ë‹µ ë°ì´í„° êµ¬ì„±
            Map<String, Object> response = new HashMap<>();
            response.put("success", true);
            response.put("token", token);
            response.put("message", "ë¡œê·¸ì¸ ì„±ê³µ");
            
            // HTTP 200 OKì™€ í•¨ê»˜ JSON ì‘ë‹µ ë°˜í™˜
            return ResponseEntity.ok(response);
            
        } else {
            // ì¸ì¦ ì‹¤íŒ¨ ì‹œ
            Map<String, Object> response = new HashMap<>();
            response.put("success", false);
            response.put("message", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
            
            // HTTP 401 Unauthorizedì™€ í•¨ê»˜ JSON ì‘ë‹µ ë°˜í™˜
            return ResponseEntity.status(401).body(response);
        }
    }
    
    @GetMapping("/protected")
    public ResponseEntity<?> protectedEndpoint(
            @RequestHeader("Authorization") String authHeader) {  // Authorization í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ
        
        try {
            // "Bearer " ì ‘ë‘ì‚¬ ì œê±°í•˜ê³  ì‹¤ì œ í† í°ë§Œ ì¶”ì¶œ
            String token = authHeader.substring(7);
            
            // í† í° ìœ íš¨ì„± ê²€ì¦
            if (jwtUtil.validateToken(token)) {
                String username = jwtUtil.getUsernameFromToken(token);
                
                Map<String, Object> response = new HashMap<>();
                response.put("success", true);
                response.put("message", "ì¸ì¦ëœ ì‚¬ìš©ì: " + username);
                response.put("data", "ë³´í˜¸ëœ ë°ì´í„°ì…ë‹ˆë‹¤.");
                
                return ResponseEntity.ok(response);
            } else {
                // í† í°ì´ ìœ íš¨í•˜ì§€ ì•ŠìŒ
                Map<String, Object> response = new HashMap<>();
                response.put("success", false);
                response.put("message", "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤.");
                
                return ResponseEntity.status(401).body(response);
            }
        } catch (Exception e) {
            // í† í° íŒŒì‹± ì¤‘ ì˜ˆì™¸ ë°œìƒ
            Map<String, Object> response = new HashMap<>();
            response.put("success", false);
            response.put("message", "í† í° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            
            return ResponseEntity.status(401).body(response);
        }
    }
}
```

---

## í˜„ì—…ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ 

### ğŸ“Š ìƒíƒœ ê´€ë¦¬ ê¸°ìˆ  ì„ í˜¸ë„ (í˜„ì—… ê¸°ì¤€)

```mermaid
pie title í˜„ì—… ìƒíƒœ ê´€ë¦¬ ê¸°ìˆ  ì‚¬ìš© ë¹„ìœ¨
    "JWT + Redis" : 40
    "Spring Session + Database" : 25
    "Traditional Session" : 20
    "Stateless (JWT Only)" : 15
```

### ğŸ¯ ìƒí™©ë³„ ê¶Œì¥ ê¸°ìˆ 

#### 1. **ëŒ€ê·œëª¨ ì„œë¹„ìŠ¤ (MSA í™˜ê²½)**
```java
// ì¶”ì²œ: JWT + Redis ì¡°í•©
@Service
public class AuthService {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;  // Redis ì—°ë™
    
    @Autowired
    private JwtUtil jwtUtil;
    
    public String login(String username, String password) {
        // 1. ì‚¬ìš©ì ì¸ì¦
        if (authenticate(username, password)) {
            
            // 2. JWT í† í° ìƒì„±
            String accessToken = jwtUtil.generateToken(username);
            String refreshToken = jwtUtil.generateRefreshToken(username);
            
            // 3. Redisì— Refresh Token ì €ì¥ (ë§Œë£Œ ì‹œê°„ê³¼ í•¨ê»˜)
            redisTemplate.opsForValue().set(
                "refresh_token:" + username, 
                refreshToken, 
                Duration.ofDays(7)  // 7ì¼ í›„ ë§Œë£Œ
            );
            
            return accessToken;
        }
        throw new UnauthorizedException("ì¸ì¦ ì‹¤íŒ¨");
    }
}
```

**ì¥ì :**
- ì„œë²„ í™•ì¥ì„± ìš°ìˆ˜ (Stateless)
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ í† í° ê³µìœ  ê°€ëŠ¥
- Redisë¡œ í† í° ê´€ë¦¬ íš¨ìœ¨ì 

#### 2. **ì¤‘ì†Œê·œëª¨ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜**
```java
// ì¶”ì²œ: Spring Session + Database
@Configuration
@EnableJdbcHttpSession  // ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜ ì„¸ì…˜ ì €ì¥
public class SessionConfig {
    
    @Bean
    public JdbcOperations jdbcTemplate(DataSource dataSource) {
        return new JdbcTemplate(dataSource);  // ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™
    }
}

@Controller
public class UserController {
    
    @PostMapping("/login")
    public String login(@RequestParam String username, 
                       @RequestParam String password,
                       HttpSession session,
                       RedirectAttributes redirectAttributes) {
        
        // ì‚¬ìš©ì ì¸ì¦ í›„ ì„¸ì…˜ì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
        User user = userService.authenticate(username, password);
        if (user != null) {
            session.setAttribute("user", user);  // ë°ì´í„°ë² ì´ìŠ¤ì— ì„¸ì…˜ ì •ë³´ ì €ì¥
            session.setAttribute("loginTime", new Date());
            
            return "redirect:/dashboard";
        } else {
            redirectAttributes.addFlashAttribute("error", "ë¡œê·¸ì¸ ì‹¤íŒ¨");
            return "redirect:/login";
        }
    }
}
```

**ì¥ì :**
- êµ¬í˜„ ë³µì¡ë„ ë‚®ìŒ
- Spring Boot ê¸°ë³¸ ê¸°ëŠ¥ í™œìš©
- ì„¸ì…˜ ë°ì´í„° ì˜êµ¬ ë³´ì¡´

#### 3. **ê¸°ì—… ë‚´ë¶€ ì‹œìŠ¤í…œ**
```java
// ì¶”ì²œ: LDAP/Active Directory ì—°ë™
@Configuration
@EnableWebSecurity
public class LdapSecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(authorize -> authorize
                .requestMatchers("/public/**").permitAll()
                .anyRequest().authenticated()
            )
            .formLogin(form -> form
                .loginPage("/login")
                .defaultSuccessUrl("/dashboard")
                .permitAll()
            )
            // LDAP ì¸ì¦ ì„¤ì •
            .ldapAuthentication(ldap -> ldap
                .userDnPatterns("uid={0},ou=users")  // ì‚¬ìš©ì DN íŒ¨í„´
                .contextSource()
                .url("ldap://localhost:8389/dc=springframework,dc=org")  // LDAP ì„œë²„ URL
            );
        
        return http.build();
    }
}
```

### ğŸ“ˆ ê¸°ìˆ ë³„ ì í•©í•œ ìƒí™©

```mermaid
graph LR
    subgraph "ì†Œê·œëª¨ í”„ë¡œì íŠ¸"
        A[Traditional Session] --> A1[ê°œë°œ ì†ë„ ì¤‘ìš”]
        A[Traditional Session] --> A2[ë‹¨ìˆœí•œ êµ¬ì¡°]
    end
    
    subgraph "ì¤‘ê°„ ê·œëª¨"
        B[Spring Session + DB] --> B1[í™•ì¥ì„± í•„ìš”]
        B[Spring Session + DB] --> B2[ì„¸ì…˜ ì˜ì†ì„± í•„ìš”]
    end
    
    subgraph "ëŒ€ê·œëª¨/MSA"
        C[JWT + Redis] --> C1[ìˆ˜í‰ í™•ì¥]
        C[JWT + Redis] --> C2[ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤]
        C[JWT + Redis] --> C3[API ì¤‘ì‹¬]
    end
    
    subgraph "ê¸°ì—… í™˜ê²½"
        D[LDAP/OAuth2] --> D1[ê¸°ì¡´ ì¸ì¦ ì‹œìŠ¤í…œ]
        D[LDAP/OAuth2] --> D2[SSO í•„ìš”]
    end
```

---

## ë³´ì•ˆ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### 1. **ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”**

```java
// service/UserService.java
@Service
public class UserService {
    
    @Autowired
    private PasswordEncoder passwordEncoder;  // BCrypt ì•”í˜¸í™”
    
    public void registerUser(String username, String rawPassword) {
        // í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ BCryptë¡œ ì•”í˜¸í™”
        String encodedPassword = passwordEncoder.encode(rawPassword);
        
        // ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
        // userRepository.save(new User(username, encodedPassword));
    }
    
    public boolean validatePassword(String rawPassword, String encodedPassword) {
        // ì…ë ¥ëœ í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ì™€ ì €ì¥ëœ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ë¹„êµ
        return passwordEncoder.matches(rawPassword, encodedPassword);
    }
}
```

### 2. **CSRF ë³´í˜¸**

```html
<!-- ëª¨ë“  POST í¼ì— CSRF í† í° í¬í•¨ (Thymeleaf ìë™ ì²˜ë¦¬) -->
<form th:action="@{/submit}" method="post">
    <!-- Thymeleafê°€ ìë™ìœ¼ë¡œ CSRF í† í°ì„ hidden inputìœ¼ë¡œ ì¶”ê°€ -->
    <input type="text" name="data">
    <button type="submit">ì œì¶œ</button>
</form>
```

### 3. **ì„¸ì…˜ ë³´ì•ˆ ì„¤ì •**

```java
// config/SessionConfig.java
@Configuration
public class SessionConfig {
    
    @Bean
    public ServletContextInitializer servletContextInitializer() {
        return servletContext -> {
            // ì„¸ì…˜ ì¿ í‚¤ ë³´ì•ˆ ì„¤ì •
            SessionCookieConfig sessionCookieConfig = 
                servletContext.getSessionCookieConfig();
            
            sessionCookieConfig.setHttpOnly(true);  // JavaScript ì ‘ê·¼ ì°¨ë‹¨
            sessionCookieConfig.setSecure(true);    // HTTPSì—ì„œë§Œ ì „ì†¡
            sessionCookieConfig.setMaxAge(1800);    // 30ë¶„ í›„ ë§Œë£Œ
            sessionCookieConfig.setSameSite(SessionCookieConfig.SameSite.STRICT);  // CSRF ê³µê²© ë°©ì§€
        };
    }
}
```

---

## ì„±ëŠ¥ ìµœì í™” íŒ

### 1. **ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§ (ë‹¤ì¤‘ ì„œë²„ í™˜ê²½)**

```java
// config/RedisSessionConfig.java
@Configuration
@EnableRedisHttpSession(maxInactiveIntervalInSeconds = 1800)  // 30ë¶„
public class RedisSessionConfig {
    
    @Bean
    public LettuceConnectionFactory connectionFactory() {
        // Redis ì„œë²„ ì—°ê²° ì„¤ì •
        return new LettuceConnectionFactory(
            new RedisStandaloneConfiguration("localhost", 6379)
        );
    }
}
```

**ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§ êµ¬ì¡°:**
```mermaid
graph TB
    subgraph "ë¡œë“œ ë°¸ëŸ°ì„œ"
        LB[Load Balancer]
    end
    
    subgraph "ì›¹ ì„œë²„ë“¤"
        WS1[Web Server 1]
        WS2[Web Server 2]
        WS3[Web Server 3]
    end
    
    subgraph "ì„¸ì…˜ ì €ì¥ì†Œ"
        Redis[(Redis Session Store)]
    end
    
    Client --> LB
    LB --> WS1
    LB --> WS2
    LB --> WS3
    
    WS1 --> Redis
    WS2 --> Redis
    WS3 --> Redis
    
    style Redis fill:#ff9999
```

### 2. **ìºì‹œ í™œìš©**

```java
// service/CacheService.java
@Service
public class CacheService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    @Cacheable(value = "userCache", key = "#userId")  // ìºì‹œ ì ìš©
    public User getUserById(Long userId) {
        // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ì ì¡°íšŒ (ìºì‹œ ë¯¸ìŠ¤ ì‹œì—ë§Œ ì‹¤í–‰)
        return userRepository.findById(userId).orElse(null);
    }
    
    @CacheEvict(value = "userCache", key = "#user.id")  // ìºì‹œ ì‚­ì œ
    public void updateUser(User user) {
        // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸ í›„ ìºì‹œì—ì„œ ì œê±°
        userRepository.save(user);
    }
}
```

---

## í˜„ì—…ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ 

### ğŸ† **1ìˆœìœ„: JWT + Redis (40%)**

**ì‚¬ìš© ì´ìœ :**
- **í™•ì¥ì„±**: ì„œë²„ ì¦ì„¤ ì‹œ ì„¸ì…˜ ê³µìœ  ë¬¸ì œ ì—†ìŒ
- **ì„±ëŠ¥**: Stateless êµ¬ì¡°ë¡œ ì„œë²„ ë¶€í•˜ ê°ì†Œ
- **MSA ì¹œí™”ì **: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ í† í° ê³µìœ  ê°€ëŠ¥
- **ëª¨ë°”ì¼ ì•± ì§€ì›**: ì¿ í‚¤ ì—†ì´ë„ ì¸ì¦ ê°€ëŠ¥

**êµ¬í˜„ ì˜ˆì‹œ:**
```yaml
# application.yml
spring:
  redis:
    host: localhost
    port: 6379
    password: your-redis-password
    timeout: 3000ms
    
jwt:
  secret: your-jwt-secret-key
  expiration: 86400000  # 24ì‹œê°„
```

### ğŸ¥ˆ **2ìˆœìœ„: Spring Session + Database (25%)**

**ì‚¬ìš© ì´ìœ :**
- **ì•ˆì •ì„±**: ì„¸ì…˜ ë°ì´í„° ì˜êµ¬ ë³´ì¡´
- **êµ¬í˜„ ìš©ì´ì„±**: Spring Boot ê¸°ë³¸ ê¸°ëŠ¥ í™œìš©
- **ë””ë²„ê¹…**: ì„¸ì…˜ ë°ì´í„° ì§ì ‘ í™•ì¸ ê°€ëŠ¥

**êµ¬í˜„ ì˜ˆì‹œ:**
```sql
-- ì„¸ì…˜ í…Œì´ë¸” (ìë™ ìƒì„±ë¨)
CREATE TABLE SPRING_SESSION (
    PRIMARY_ID CHAR(36) NOT NULL,
    SESSION_ID CHAR(36) NOT NULL,
    CREATION_TIME BIGINT NOT NULL,
    LAST_ACCESS_TIME BIGINT NOT NULL,
    MAX_INACTIVE_INTERVAL INT NOT NULL,
    EXPIRY_TIME BIGINT NOT NULL,
    PRINCIPAL_NAME VARCHAR(100),
    CONSTRAINT SPRING_SESSION_PK PRIMARY KEY (PRIMARY_ID)
);
```

### ğŸ¥‰ **3ìˆœìœ„: OAuth2 + JWT (20%)**

**ì‚¬ìš© ì´ìœ :**
- **SSO**: êµ¬ê¸€, í˜ì´ìŠ¤ë¶ ë“± ì†Œì…œ ë¡œê·¸ì¸
- **ë³´ì•ˆ**: íƒ€ì‚¬ ì¸ì¦ ì„œë¹„ìŠ¤ í™œìš©
- **ì‚¬ìš©ì í¸ì˜ì„±**: ë³„ë„ íšŒì›ê°€ì… ë¶ˆí•„ìš”

```java
// OAuth2 ì„¤ì •
@Configuration
@EnableOAuth2Client
public class OAuth2Config {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .oauth2Login(oauth2 -> oauth2
                .loginPage("/login")
                .defaultSuccessUrl("/dashboard")
                .userInfoEndpoint(userInfo -> userInfo
                    .userService(customOAuth2UserService)  // ì»¤ìŠ¤í…€ ì‚¬ìš©ì ì„œë¹„ìŠ¤
                )
            );
        return http.build();
    }
}
```

### ğŸ“‹ **ê¸°ìˆ  ì„ íƒ ê°€ì´ë“œ**

| í”„ë¡œì íŠ¸ ê·œëª¨ | ì¶”ì²œ ê¸°ìˆ  | ì´ìœ  |
|---------------|-----------|------|
| **ìŠ¤íƒ€íŠ¸ì—…/MVP** | Traditional Session | ë¹ ë¥¸ ê°œë°œ, ë‹¨ìˆœí•¨ |
| **ì¤‘ì†Œê¸°ì—… ì›¹ì„œë¹„ìŠ¤** | Spring Session + DB | ì•ˆì •ì„±ê³¼ í™•ì¥ì„± ê· í˜• |
| **ëŒ€ê¸°ì—…/ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤** | JWT + Redis | ìˆ˜í‰ í™•ì¥, ì„±ëŠ¥ ìµœì í™” |
| **B2B ê¸°ì—… ì†”ë£¨ì…˜** | LDAP/OAuth2 | ê¸°ì¡´ ì¸í”„ë¼ í™œìš©, SSO |

---

## ì‹¤ì œ í”„ë¡œë•ì…˜ ì½”ë“œ ì˜ˆì œ

### ì¢…í•© ë³´ì•ˆ ì„¤ì • (í˜„ì—… í‘œì¤€)

```java
// config/ProductionSecurityConfig.java
@Configuration
@EnableWebSecurity
@EnableMethodSecurity(prePostEnabled = true)  // ë©”ì„œë“œ ë ˆë²¨ ë³´ì•ˆ í™œì„±í™”
public class ProductionSecurityConfig {
    
    @Autowired
    private JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint;
    
    @Autowired
    private JwtRequestFilter jwtRequestFilter;
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            // CORS ì„¤ì •
            .cors(cors -> cors.configurationSource(corsConfigurationSource()))
            
            // CSRF ì„¤ì • (APIëŠ” ë¹„í™œì„±í™”, ì›¹ì€ í™œì„±í™”)
            .csrf(csrf -> csrf
                .ignoringRequestMatchers("/api/**")  // REST APIëŠ” CSRF ë¹„í™œì„±í™”
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
            )
            
            // ì„¸ì…˜ ê´€ë¦¬ ì •ì±…
            .sessionManagement(session -> session
                .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)
                .maximumSessions(1)  // ë™ì‹œ ì„¸ì…˜ 1ê°œë¡œ ì œí•œ
                .maxSessionsPreventsLogin(false)  // ìƒˆ ë¡œê·¸ì¸ ì‹œ ê¸°ì¡´ ì„¸ì…˜ ë§Œë£Œ
                .sessionRegistry(sessionRegistry())
            )
            
            // URLë³„ ì ‘ê·¼ ê¶Œí•œ
            .authorizeHttpRequests(authorize -> authorize
                .requestMatchers("/", "/login", "/register", "/api/auth/**").permitAll()
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .requestMatchers("/api/**").authenticated()
                .anyRequest().authenticated()
            )
            
            // JWT í•„í„° ì¶”ê°€
            .addFilterBefore(jwtRequestFilter, UsernamePasswordAuthenticationFilter.class)
            
            // ì˜ˆì™¸ ì²˜ë¦¬
            .exceptionHandling(exception -> exception
                .authenticationEntryPoint(jwtAuthenticationEntryPoint)
                .accessDeniedHandler(customAccessDeniedHandler())
            )
            
            // ë¡œê·¸ì•„ì›ƒ ì„¤ì •
            .logout(logout -> logout
                .logoutUrl("/logout")
                .logoutSuccessUrl("/login?logout=true")
                .invalidateHttpSession(true)
                .deleteCookies("JSESSIONID", "remember-me")
                .addLogoutHandler(customLogoutHandler())  // ì»¤ìŠ¤í…€ ë¡œê·¸ì•„ì›ƒ í•¸ë“¤ëŸ¬
            );
            
        return http.build();
    }
    
    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        
        // í—ˆìš©í•  ì˜¤ë¦¬ì§„ ì„¤ì • (í”„ë¡œë•ì…˜ì—ì„œëŠ” êµ¬ì²´ì ì¸ ë„ë©”ì¸ ì§€ì •)
        configuration.setAllowedOriginPatterns(List.of("https://*.yourdomain.com"));
        
        // í—ˆìš©í•  HTTP ë©”ì„œë“œ
        configuration.setAllowedMethods(List.of("GET", "POST", "PUT", "DELETE", "PATCH"));
        
        // í—ˆìš©í•  í—¤ë”
        configuration.setAllowedHeaders(List.of("*"));
        
        // ìê²© ì¦ëª… í—ˆìš© (ì¿ í‚¤, Authorization í—¤ë” ë“±)
        configuration.setAllowCredentials(true);
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        
        return source;
    }
}
```

### ì‹¤ì‹œê°„ ìƒíƒœ ê´€ë¦¬ (WebSocket + Session)

```java
// config/WebSocketConfig.java
@Configuration
@EnableWebSocket  // WebSocket í™œì„±í™”
public class WebSocketConfig implements WebSocketConfigurer {
    
    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        // WebSocket í•¸ë“¤ëŸ¬ ë“±ë¡
        registry.addHandler(new ChatWebSocketHandler(), "/chat")
                .setAllowedOrigins("*")  // CORS ì„¤ì •
                .withSockJS();  // SockJS í´ë°± ì§€ì›
    }
}

// handler/ChatWebSocketHandler.java
@Component
public class ChatWebSocketHandler extends TextWebSocketHandler {
    
    // ì—°ê²°ëœ ì„¸ì…˜ë“¤ì„ ì €ì¥í•˜ëŠ” ë™ì‹œì„± ì•ˆì „í•œ ë§µ
    private final Map<String, WebSocketSession> sessions = new ConcurrentHashMap<>();
    
    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        // ì›¹ì†Œì¼“ ì—°ê²° ì‹œ ì„¸ì…˜ ì €ì¥
        String sessionId = session.getId();
        sessions.put(sessionId, session);
        
        // ì—°ê²° ì•Œë¦¼ ë©”ì‹œì§€ ì „ì†¡
        session.sendMessage(new TextMessage("ì±„íŒ…ë°©ì— ì…ì¥í–ˆìŠµë‹ˆë‹¤."));
        
        // ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ìƒˆ ì‚¬ìš©ì ì…ì¥ ì•Œë¦¼
        broadcastMessage("ìƒˆë¡œìš´ ì‚¬ìš©ìê°€ ì…ì¥í–ˆìŠµë‹ˆë‹¤.", sessionId);
    }
    
    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
        // ë°›ì€ ë©”ì‹œì§€ë¥¼ ëª¨ë“  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
        String payload = message.getPayload();
        broadcastMessage(payload, session.getId());
    }
    
    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        // ì—°ê²° ì¢…ë£Œ ì‹œ ì„¸ì…˜ ì œê±°
        String sessionId = session.getId();
        sessions.remove(sessionId);
        
        // ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ì‚¬ìš©ì í‡´ì¥ ì•Œë¦¼
        broadcastMessage("ì‚¬ìš©ìê°€ í‡´ì¥í–ˆìŠµë‹ˆë‹¤.", sessionId);
    }
    
    // ëª¨ë“  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì‹œì§€ ì „ì†¡
    private void broadcastMessage(String message, String excludeSessionId) {
        sessions.forEach((sessionId, webSocketSession) -> {
            if (!sessionId.equals(excludeSessionId) && webSocketSession.isOpen()) {
                try {
                    webSocketSession.sendMessage(new TextMessage(message));
                } catch (Exception e) {
                    // ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ ì„¸ì…˜ ì œê±°
                    sessions.remove(sessionId);
                }
            }
        });
    }
}
```

---

## ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹…

```java
// config/SecurityEventListener.java
@Component
public class SecurityEventListener {
    
    private static final Logger logger = LoggerFactory.getLogger(SecurityEventListener.class);
    
    @EventListener  // Spring ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    public void handleAuthenticationSuccess(AuthenticationSuccessEvent event) {
        // ë¡œê·¸ì¸ ì„±ê³µ ì´ë²¤íŠ¸ ì²˜ë¦¬
        String username = event.getAuthentication().getName();
        String timestamp = new Date().toString();
        
        logger.info("ë¡œê·¸ì¸ ì„±ê³µ - ì‚¬ìš©ì: {}, ì‹œê°„: {}", username, timestamp);
        
        // ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” ë³´ì•ˆ ë¡œê·¸ ì‹œìŠ¤í…œì— ê¸°ë¡
        // securityLogService.logLoginSuccess(username, getClientIP(), timestamp);
    }
    
    @EventListener
    public void handleAuthenticationFailure(AbstractAuthenticationFailureEvent event) {
        // ë¡œê·¸ì¸ ì‹¤íŒ¨ ì´ë²¤íŠ¸ ì²˜ë¦¬
        String username = event.getAuthentication().getName();
        String reason = event.getException().getMessage();
        
        logger.warn("ë¡œê·¸ì¸ ì‹¤íŒ¨ - ì‚¬ìš©ì: {}, ì›ì¸: {}", username, reason);
        
        // ì—°ì† ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¸ˆ ë¡œì§ ë“± êµ¬í˜„ ê°€ëŠ¥
        // securityService.handleLoginFailure(username);
    }
}
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```java
// config/ActuatorConfig.java
@Configuration
public class ActuatorConfig {
    
    @Bean
    public TimedAspect timedAspect(MeterRegistry registry) {
        return new TimedAspect(registry);  // ë©”ì„œë“œ ì‹¤í–‰ ì‹œê°„ ì¸¡ì •
    }
}

// ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì„±ëŠ¥ ì¸¡ì •
@Controller
public class MonitoredController {
    
    @Timed(name = "user.login.time", description = "ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œê°„")  // ì‹¤í–‰ ì‹œê°„ ì¸¡ì •
    @PostMapping("/login")
    public String login(@RequestParam String username, 
                       @RequestParam String password,
                       HttpSession session) {
        // ë¡œê·¸ì¸ ë¡œì§
        return "redirect:/dashboard";
    }
}
```

---

## ğŸ“š í•™ìŠµ ë¡œë“œë§µ

### ì´ˆê¸‰ ê°œë°œì
1. **Spring Boot ê¸°ë³¸** â†’ Model, RedirectAttributes ì´í•´
2. **ì„¸ì…˜ ê´€ë¦¬** â†’ HttpSession í™œìš©
3. **ê¸°ë³¸ ë³´ì•ˆ** â†’ Spring Security í¼ ë¡œê·¸ì¸

### ì¤‘ê¸‰ ê°œë°œì  
1. **JWT êµ¬í˜„** â†’ í† í° ê¸°ë°˜ ì¸ì¦
2. **Redis ì—°ë™** â†’ ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§
3. **ì˜ˆì™¸ ì²˜ë¦¬** â†’ ê¸€ë¡œë²Œ ì˜ˆì™¸ í•¸ë“¤ëŸ¬

### ê³ ê¸‰ ê°œë°œì
1. **OAuth2 ì—°ë™** â†’ ì†Œì…œ ë¡œê·¸ì¸
2. **ë³´ì•ˆ ê°•í™”** â†’ CORS, CSRF, XSS ë°©ì§€
3. **ëª¨ë‹ˆí„°ë§** â†’ ë¡œê¹…, ë©”íŠ¸ë¦­ ìˆ˜ì§‘

---

## ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ ì˜ì¡´ì„± (build.gradle)

```gradle
dependencies {
    // Spring Boot ê¸°ë³¸
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    
    // ë³´ì•ˆ
    implementation 'org.springframework.boot:spring-boot-starter-security'
    
    // ì„¸ì…˜ ê´€ë¦¬
    implementation 'org.springframework.session:spring-session-core'
    implementation 'org.springframework.session:spring-session-jdbc'  // DB ê¸°ë°˜ ì„¸ì…˜
    // ë˜ëŠ”
    implementation 'org.springframework.session:spring-session-data-redis'  // Redis ê¸°ë°˜ ì„¸ì…˜
    
    // JWT
    implementation 'io.jsonwebtoken:jjwt-api:0.11.5'
    implementation 'io.jsonwebtoken:jjwt-impl:0.11.5'
    implementation 'io.jsonwebtoken:jjwt-jackson:0.11.5'
    
    // ë°ì´í„°ë² ì´ìŠ¤
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    runtimeOnly 'com.h2database:h2'  // ê°œë°œìš©
    // runtimeOnly 'mysql:mysql-connector-java'  // ìš´ì˜ìš©
    
    // ëª¨ë‹ˆí„°ë§
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'io.micrometer:micrometer-registry-prometheus'
    
    // í…ŒìŠ¤íŠ¸
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.springframework.security:spring-security-test'
}
```

---

## ğŸ¯ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ë¹„ë°€ë²ˆí˜¸ BCrypt ì•”í˜¸í™”
- [ ] HTTPS ì ìš©
- [ ] CSRF ë³´í˜¸ í™œì„±í™”
- [ ] XSS ë°©ì§€ í—¤ë” ì„¤ì •
- [ ] ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •
- [ ] ë¡œê·¸ì¸ ì‹¤íŒ¨ ì œí•œ
- [ ] ë³´ì•ˆ í—¤ë” ì„¤ì • (X-Frame-Options, X-Content-Type-Options ë“±)

### âœ… ì„±ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸  
- [ ] ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§ êµ¬ì„±
- [ ] ìºì‹œ ì „ëµ ìˆ˜ë¦½
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ ìµœì í™”
- [ ] ì •ì  ë¦¬ì†ŒìŠ¤ CDN ì‚¬ìš©
- [ ] ì••ì¶• í™œì„±í™” (Gzip)

### âœ… ëª¨ë‹ˆí„°ë§ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ë¡œê·¸ ìˆ˜ì§‘ ì²´ê³„ êµ¬ì¶•
- [ ] ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- [ ] ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹…
- [ ] ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] ëŒ€ì‹œë³´ë“œ êµ¬ì„±

---

## ğŸš€ ë§ˆë¬´ë¦¬

Spring Bootì—ì„œ ìƒíƒœ ê´€ë¦¬ì™€ ë³´ì•ˆì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ì…ë‹ˆë‹¤. í”„ë¡œì íŠ¸ ê·œëª¨ì™€ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ì ì ˆí•œ ê¸°ìˆ ì„ ì„ íƒí•˜ì—¬ ì•ˆì „í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ì„¸ìš”.

**í˜„ì—… íŒ:**
- ì‹œì‘ì€ ê°„ë‹¨í•˜ê²Œ, í•„ìš”ì— ë”°ë¼ ì ì§„ì ìœ¼ë¡œ ë³µì¡ë„ ì¦ê°€
- ë³´ì•ˆì€ ì²˜ìŒë¶€í„° ê³ ë ¤í•˜ì—¬ ì„¤ê³„
- ëª¨ë‹ˆí„°ë§ê³¼ ë¡œê¹…ì€ í•„ìˆ˜
- íŒ€ì˜ ê¸°ìˆ  ìˆ˜ì¤€ê³¼ ìœ ì§€ë³´ìˆ˜ ëŠ¥ë ¥ ê³ ë ¤

**ì¶”ê°€ í•™ìŠµ ìë£Œ:**
- [Spring Security ê³µì‹ ë¬¸ì„œ](https://spring.io/projects/spring-security)
- [Spring Session ë¬¸ì„œ](https://spring.io/projects/spring-session)
- [JWT ê³µì‹ ì‚¬ì´íŠ¸](https://jwt.io/)
- [Redis ê³µì‹ ë¬¸ì„œ](https://redis.io/documentation) Flash Attribute ì¶”ê°€: ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ í•œ ë²ˆë§Œ ì‚¬ìš© ê°€ëŠ¥
            // ì„¸ì…˜ì„ ì„ì‹œë¡œ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê³ , ì‚¬ìš© í›„ ì¦‰ì‹œ ì‚­ì œë¨
            redirectAttributes.addFlashAttribute("message", "ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
            redirectAttributes.addFlashAttribute("messageType", "success");
        } else {
            redirectAttributes.addFlashAttribute("message", "ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            redirectAttributes.addFlashAttribute("messageType", "error");
        }
        
        // ë¦¬ë‹¤ì´ë ‰íŠ¸: ë¸Œë¼ìš°ì €ì—ê²Œ ìƒˆë¡œìš´ URLë¡œ ì´ë™í•˜ë¼ê³  ì§€ì‹œ
        // POST í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ ìƒˆë¡œê³ ì¹¨ ì‹œ ì¤‘ë³µ ì œì¶œ ë°©ì§€ (PRG íŒ¨í„´)
        return "redirect:/result";
    }
    
    @GetMapping("/result")  // ë¦¬ë‹¤ì´ë ‰íŠ¸ëœ ìš”ì²­ì„ ì²˜ë¦¬
    public String showResult() {
        // Flash AttributeëŠ” ìë™ìœ¼ë¡œ Modelì— ì¶”ê°€ë˜ë¯€ë¡œ
        // ë³„ë„ì˜ ì‘ì—… ì—†ì´ Viewì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
        return "result";
    }
}
```

```html
<!-- templates/result.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ê²°ê³¼ í˜ì´ì§€</title>
    <style>
        .alert-success { color: green; background: #d4edda; padding: 10px; }
        .alert-error { color: red; background: #f8d7da; padding: 10px; }
    </style>
</head>
<body>
    <!-- th:ifëŠ” ì¡°ê±´ë¶€ ë Œë”ë§ - messageê°€ ì¡´ì¬í•  ë•Œë§Œ div í‘œì‹œ -->
    <div th:if="${message}" 
         th:class="${messageType == 'success'} ? 'alert-success' : 'alert-error'">
        <!-- Flash Attributeë¡œ ì „ë‹¬ëœ ë©”ì‹œì§€ í‘œì‹œ -->
        <p th:text="${message}"></p>
    </div>
    
    <h2>ê²°ê³¼ í˜ì´ì§€</h2>
    <a href="/save-data">ë‹¤ì‹œ ì €ì¥í•˜ê¸°</a>
</body>
</html>
```

### PRG íŒ¨í„´ ì‹œê°í™”
```mermaid
sequenceDiagram
    participant C as Client
    participant SC as Spring Controller
    participant S as Session
    participant DB as Database
    
    C->>SC: POST /save-data (í¼ ë°ì´í„°)
    SC->>DB: ë°ì´í„° ì €ì¥
    DB->>SC: ì €ì¥ ì™„ë£Œ
    SC->>S: addFlashAttribute (ì„ì‹œ ì €ì¥)
    SC->>C: 302 Redirect to /result
    C->>SC: GET /result (ìƒˆë¡œìš´ ìš”ì²­)
    SC->>S: Flash Attribute ì¡°íšŒ
    S->>SC: ë°ì´í„° ë°˜í™˜ í›„ ì‚­ì œ
    SC->>C: HTML ì‘ë‹µ (ì„±ê³µ ë©”ì‹œì§€ í¬í•¨)
```

---

## Sessionì„ ì´ìš©í•œ ìƒíƒœ ê´€ë¦¬

### ê°œë…
- **ì—¬ëŸ¬ ìš”ì²­ì— ê±¸ì³ ìƒíƒœ ìœ ì§€**
- ì„œë²„ ë©”ëª¨ë¦¬ì— ì‚¬ìš©ìë³„ ë…ë¦½ëœ ì €ì¥ ê³µê°„
- JSESSIONID ì¿ í‚¤ë¡œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„¸ì…˜ ë§¤ì¹­

### ì½”ë“œ ì˜ˆì œ

```java
// controller/SessionController.java
package com.example.demo.controller;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpSession;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class SessionController {
    
    @GetMapping("/visit")
    public String trackVisit(HttpServletRequest request, Model model) {
        
        // HttpServletRequestì—ì„œ ì„¸ì…˜ ê°ì²´ ê°€ì ¸ì˜¤ê¸°
        // true: ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±, false: ì„¸ì…˜ì´ ì—†ìœ¼ë©´ null ë°˜í™˜
        HttpSession session = request.getSession(true);
        
        // ì„¸ì…˜ì—ì„œ "visitCount" ì†ì„±ê°’ ê°€ì ¸ì˜¤ê¸°
        // ì²« ë°©ë¬¸ì´ë©´ nullì´ ë°˜í™˜ë¨
        Integer visitCount = (Integer) session.getAttribute("visitCount");
        
        // ì²« ë°©ë¬¸ì¸ì§€ í™•ì¸
        if (visitCount == null) {
            visitCount = 1;  // ì²« ë°©ë¬¸ì´ë©´ 1ë¡œ ì„¤ì •
        } else {
            visitCount++;    // ë°©ë¬¸ íšŸìˆ˜ ì¦ê°€
        }
        
        // ì—…ë°ì´íŠ¸ëœ ë°©ë¬¸ íšŸìˆ˜ë¥¼ ì„¸ì…˜ì— ë‹¤ì‹œ ì €ì¥
        // ì´ ê°’ì€ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ì„ ë•Œê¹Œì§€ (ë˜ëŠ” ì„¸ì…˜ íƒ€ì„ì•„ì›ƒê¹Œì§€) ìœ ì§€ë¨
        session.setAttribute("visitCount", visitCount);
        
        // í˜„ì¬ ë°©ë¬¸ íšŸìˆ˜ë¥¼ Modelì— ë‹´ì•„ Viewë¡œ ì „ë‹¬
        model.addAttribute("count", visitCount);
        
        return "visit-count";
    }
    
    @GetMapping("/logout-session")
    public String logout(HttpSession session) {
        // ì„¸ì…˜ ë¬´íš¨í™”: ì„¸ì…˜ì— ì €ì¥ëœ ëª¨ë“  ë°ì´í„° ì‚­ì œ
        // ìƒˆë¡œìš´ ì„¸ì…˜ IDê°€ ìƒì„±ë¨
        session.invalidate();
        
        // ë¡œê·¸ì•„ì›ƒ í›„ ë°©ë¬¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
        return "redirect:/visit";
    }
    
    @GetMapping("/session-info")
    public String sessionInfo(HttpSession session, Model model) {
        // ì„¸ì…˜ ID ì¡°íšŒ (JSESSIONID)
        String sessionId = session.getId();
        
        // ì„¸ì…˜ ìƒì„± ì‹œê°„ ì¡°íšŒ
        long creationTime = session.getCreationTime();
        
        // ë§ˆì§€ë§‰ ì ‘ê·¼ ì‹œê°„ ì¡°íšŒ
        long lastAccessedTime = session.getLastAccessedTime();
        
        // ì„¸ì…˜ ìµœëŒ€ ë¹„í™œì„± ì‹œê°„ ì¡°íšŒ (ì´ˆ ë‹¨ìœ„)
        int maxInactiveInterval = session.getMaxInactiveInterval();
        
        // Modelì— ì„¸ì…˜ ì •ë³´ ì¶”ê°€
        model.addAttribute("sessionId", sessionId);
        model.addAttribute("creationTime", new java.util.Date(creationTime));
        model.addAttribute("lastAccessedTime", new java.util.Date(lastAccessedTime));
        model.addAttribute("maxInactiveInterval", maxInactiveInterval);
        
        return "session-info";
    }
}
```

```html
<!-- templates/visit-count.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ë°©ë¬¸ íšŸìˆ˜ ì¶”ì </title>
</head>
<body>
    <h1>ë°©ë¬¸ íšŸìˆ˜ ì¶”ì </h1>
    
    <!-- Modelë¡œ ì „ë‹¬ëœ count ê°’ì„ í‘œì‹œ -->
    <p>ë‹¹ì‹ ì€ ì´ í˜ì´ì§€ë¥¼ <strong th:text="${count}">0</strong>ë²ˆ ë°©ë¬¸í–ˆìŠµë‹ˆë‹¤.</p>
    
    <div>
        <a href="/visit">í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</a> | 
        <a href="/logout-session">ì„¸ì…˜ ì´ˆê¸°í™”</a> |
        <a href="/session-info">ì„¸ì…˜ ì •ë³´ ë³´ê¸°</a>
    </div>
</body>
</html>
```

### ì„¸ì…˜ ìƒëª…ì£¼ê¸°
```mermaid
stateDiagram-v2
    [*] --> ì„¸ì…˜ìƒì„±: ì²« ë°©ë¬¸
    ì„¸ì…˜ìƒì„± --> ì„¸ì…˜í™œì„±: ë°ì´í„° ì €ì¥
    ì„¸ì…˜í™œì„± --> ì„¸ì…˜í™œì„±: ìš”ì²­ ì²˜ë¦¬
    ì„¸ì…˜í™œì„± --> ì„¸ì…˜ë§Œë£Œ: íƒ€ì„ì•„ì›ƒ
    ì„¸ì…˜í™œì„± --> ì„¸ì…˜ë¬´íš¨í™”: logout()
    ì„¸ì…˜ë§Œë£Œ --> [*]
    ì„¸ì…˜ë¬´íš¨í™” --> [*]
```

---

## RedirectAttributesë¥¼ ì´ìš©í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°ì´í„° ì „ë‹¬

### ê°œë…
- **PRG(Post-Redirect-Get) íŒ¨í„´**ì—ì„œ ì‚¬ìš©
- Flash Attributeë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ í•œ ë²ˆë§Œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„° ì „ë‹¬

### ì½”ë“œ ì˜ˆì œ

```java
// controller/FormController.java
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@Controller
public class FormController {
    
    @GetMapping("/form")
    public String showForm() {
        // í¼ì„ ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ ë°˜í™˜
        return "user-form";
    }
    
    @PostMapping("/submit")
    public String submitForm(
            @RequestParam String name,  // í¼ì—ì„œ ì „ì†¡ëœ name íŒŒë¼ë¯¸í„°
            @RequestParam String email, // í¼ì—ì„œ ì „ì†¡ëœ email íŒŒë¼ë¯¸í„°
            RedirectAttributes redirectAttributes) {
        
        try {
            // ì…ë ¥ê°’ ê²€ì¦
            if (name == null || name.trim().isEmpty()) {
                throw new IllegalArgumentException("ì´ë¦„ì€ í•„ìˆ˜ ì…ë ¥ ì‚¬í•­ì…ë‹ˆë‹¤.");
            }
            
            if (email == null || !email.contains("@")) {
                throw new IllegalArgumentException("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.");
            }
            
            // ì‹¤ì œë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë¡œì§
            // User user = userService.save(new User(name, email));
            
            // ì„±ê³µ ì‹œ Flash Attribute ì„¤ì •
            redirectAttributes.addFlashAttribute("successMessage", 
                name + "ë‹˜ì˜ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
            redirectAttributes.addFlashAttribute("messageType", "success");
            
        } catch (Exception e) {
            // ì‹¤íŒ¨ ì‹œ Flash Attribute ì„¤ì •
            redirectAttributes.addFlashAttribute("errorMessage", e.getMessage());
            redirectAttributes.addFlashAttribute("messageType", "error");
        }
        
        // POST í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ ì¤‘ë³µ ì œì¶œ ë°©ì§€
        return "redirect:/form";
    }
}
```

```html
<!-- templates/user-form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ì‚¬ìš©ì ì •ë³´ ì…ë ¥</title>
    <style>
        .alert-success { color: green; background: #d4edda; padding: 10px; margin: 10px 0; }
        .alert-error { color: red; background: #f8d7da; padding: 10px; margin: 10px 0; }
        .form-group { margin: 10px 0; }
        input { padding: 5px; width: 200px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; }
    </style>
</head>
<body>
    <h1>ì‚¬ìš©ì ì •ë³´ ì…ë ¥</h1>
    
    <!-- Flash Attributeë¡œ ì „ë‹¬ëœ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ -->
    <div th:if="${successMessage}" class="alert-success">
        <p th:text="${successMessage}"></p>
    </div>
    
    <!-- Flash Attributeë¡œ ì „ë‹¬ëœ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ -->
    <div th:if="${errorMessage}" class="alert-error">
        <p th:text="${errorMessage}"></p>
    </div>
    
    <!-- ì‚¬ìš©ì ì •ë³´ ì…ë ¥ í¼ -->
    <form method="post" action="/submit">
        <div class="form-group">
            <label for="name">ì´ë¦„:</label>
            <input type="text" id="name" name="name" required>
        </div>
        
        <div class="form-group">
            <label for="email">ì´ë©”ì¼:</label>
            <input type="email" id="email" name="email" required>
        </div>
        
        <button type="submit">ì €ì¥</button>
    </form>
</body>
</html>
```

---

## Cookieë¥¼ ì´ìš©í•œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬

### ê°œë…
- **í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €**ì— ì €ì¥ë˜ëŠ” ì‘ì€ í…ìŠ¤íŠ¸ ì¡°ê°
- ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ê°€ ë‹¤ì‹œ ì„œë²„ë¡œ ì „ì†¡

### ì½”ë“œ ì˜ˆì œ

```java
// controller/CookieController.java
package com.example.demo.controller;

import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.CookieValue;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class CookieController {
    
    @PostMapping("/set-theme")
    public String setTheme(
            @RequestParam String theme,  // í¼ì—ì„œ ì„ íƒëœ í…Œë§ˆ
            HttpServletResponse response) {  // HTTP ì‘ë‹µ ê°ì²´
        
        // ìƒˆë¡œìš´ ì¿ í‚¤ ìƒì„±: ì´ë¦„ì€ "theme", ê°’ì€ ì‚¬ìš©ìê°€ ì„ íƒí•œ í…Œë§ˆ
        Cookie themeCookie = new Cookie("theme", theme);
        
        // ì¿ í‚¤ ì„¤ì •
        themeCookie.setPath("/");  // ëª¨ë“  ê²½ë¡œì—ì„œ ì¿ í‚¤ ì‚¬ìš© ê°€ëŠ¥
        themeCookie.setMaxAge(60 * 60 * 24 * 30);  // ìœ íš¨ ê¸°ê°„: 30ì¼ (ì´ˆ ë‹¨ìœ„)
        themeCookie.setHttpOnly(true);  // JavaScriptì—ì„œ ì ‘ê·¼ ë¶ˆê°€ (ë³´ì•ˆ)
        
        // HTTP ì‘ë‹µì— ì¿ í‚¤ ì¶”ê°€ - ë¸Œë¼ìš°ì €ê°€ ì´ ì¿ í‚¤ë¥¼ ì €ì¥í•¨
        response.addCookie(themeCookie);
        
        return "redirect:/show-theme";
    }
    
    @GetMapping("/show-theme")
    public String showTheme(
            // @CookieValue: "theme" ì¿ í‚¤ ê°’ì„ theme ë³€ìˆ˜ì— ìë™ ë°”ì¸ë”©
            // defaultValue: ì¿ í‚¤ê°€ ì—†ì„ ë•Œ ì‚¬ìš©í•  ê¸°ë³¸ê°’
            @CookieValue(name = "theme", defaultValue = "light") String theme,
            Model model) {
        
        // í˜„ì¬ í…Œë§ˆë¥¼ Modelì— ì¶”ê°€í•˜ì—¬ Viewì—ì„œ ì‚¬ìš©
        model.addAttribute("currentTheme", theme);
        
        return "theme-display";
    }
    
    @GetMapping("/delete-theme")
    public String deleteTheme(HttpServletResponse response) {
        
        // ì¿ í‚¤ ì‚­ì œë¥¼ ìœ„í•´ ê°™ì€ ì´ë¦„ì˜ ì¿ í‚¤ë¥¼ ìƒì„±í•˜ê³  MaxAgeë¥¼ 0ìœ¼ë¡œ ì„¤ì •
        Cookie deleteCookie = new Cookie("theme", "");
        deleteCookie.setPath("/");
        deleteCookie.setMaxAge(0);  // ì¦‰ì‹œ ë§Œë£Œ
        
        // ë¸Œë¼ìš°ì €ì—ê²Œ ì¿ í‚¤ ì‚­ì œ ì§€ì‹œ
        response.addCookie(deleteCookie);
        
        return "redirect:/show-theme";
    }
}
```

```html
<!-- templates/theme-display.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>í…Œë§ˆ ì„¤ì •</title>
    <!-- ì¡°ê±´ë¶€ CSS: í˜„ì¬ í…Œë§ˆì— ë”°ë¼ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ ì ìš© -->
    <style th:if="${currentTheme == 'dark'}">
        body { background-color: #121212; color: white; }
        .theme-selector { background: #333; padding: 20px; }
    </style>
    <style th:if="${currentTheme == 'light'}">
        body { background-color: white; color: black; }
        .theme-selector { background: #f5f5f5; padding: 20px; }
    </style>
</head>
<body>
    <div class="theme-selector">
        <h1>í…Œë§ˆ ì„¤ì •</h1>
        
        <!-- í˜„ì¬ í…Œë§ˆ í‘œì‹œ -->
        <p>í˜„ì¬ í…Œë§ˆ: <strong th:text="${currentTheme}">light</strong></p>
        
        <!-- í…Œë§ˆ ë³€ê²½ í¼ -->
        <form method="post" action="/set-theme">
            <label>
                <input type="radio" name="theme" value="light" 
                       th:checked="${currentTheme == 'light'}"> ë¼ì´íŠ¸ í…Œë§ˆ
            </label>
            <label>
                <input type="radio" name="theme" value="dark" 
                       th:checked="${currentTheme == 'dark'}"> ë‹¤í¬ í…Œë§ˆ
            </label>
            <button type="submit">í…Œë§ˆ ë³€ê²½</button>
        </form>
        
        <div>
            <a href="/delete-theme">í…Œë§ˆ ì„¤ì • ì´ˆê¸°í™”</a>
        </div>
    </div>
</body>
</html>
```

### ì¿ í‚¤ vs ì„¸ì…˜ ë¹„êµ
```mermaid
graph TB
    subgraph "Cookie (í´ë¼ì´ì–¸íŠ¸ ì €ì¥)"
        A[ë¸Œë¼ìš°ì €ì— ì €ì¥] --> B[ìš©ëŸ‰ ì œí•œ 4KB]
        B --> C[ë³´ì•ˆ ì·¨ì•½]
        C --> D[ì‚¬ìš©ìê°€ ì‚­ì œ/ìˆ˜ì • ê°€ëŠ¥]
    end
    
    subgraph "Session (ì„œë²„ ì €ì¥)"
        E[ì„œë²„ ë©”ëª¨ë¦¬ì— ì €ì¥] --> F[ìš©ëŸ‰ ì œí•œ ì—†ìŒ]
        F --> G[ìƒëŒ€ì ìœ¼ë¡œ ì•ˆì „]
        G --> H[ì„œë²„ì—ì„œë§Œ ê´€ë¦¬]
    end
    
    style A fill:#ffcdd2
    style E fill:#c8e6c9
```

---

## Spring Security ê¸°ë³¸ ì„¤ì •

### ê°œë…
- Spring Bootì˜ **ì¸ì¦(Authentication)ê³¼ ì¸ê°€(Authorization)** í”„ë ˆì„ì›Œí¬
- ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  URLì„ ë³´í˜¸í•˜ê³  í¼ ë¡œê·¸ì¸ ì œê³µ

### ê¸°ë³¸ Security ì„¤ì •

```java
// config/SecurityConfig.java
package com.example.demo.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;

@Configuration  // Spring ì„¤ì • í´ë˜ìŠ¤ì„ì„ ì„ ì–¸
@EnableWebSecurity  // Spring Security í™œì„±í™”
public class SecurityConfig {
    
    @Bean  // Spring ì»¨í…Œì´ë„ˆì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°ì²´ë¡œ ë“±ë¡
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            // URLë³„ ì ‘ê·¼ ê¶Œí•œ ì„¤ì •
            .authorizeHttpRequests(authorize -> authorize
                // "/", "/login", "/css/**", "/js/**" ê²½ë¡œëŠ” ëª¨ë“  ì‚¬ìš©ì ì ‘ê·¼ í—ˆìš©
                .requestMatchers("/", "/login", "/css/**", "/js/**").permitAll()
                
                // "/admin/**" ê²½ë¡œëŠ” ADMIN ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
                .requestMatchers("/admin/**").hasRole("ADMIN")
                
                // "/user/**" ê²½ë¡œëŠ” USER ë˜ëŠ” ADMIN ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ì ì ‘ê·¼ ê°€ëŠ¥
                .requestMatchers("/user/**").hasAnyRole("USER", "ADMIN")
                
                // ë‚˜ë¨¸ì§€ ëª¨ë“  ìš”ì²­ì€ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
                .anyRequest().authenticated()
            )
            
            // í¼ ë¡œê·¸ì¸ ì„¤ì •
            .formLogin(form -> form
                .loginPage("/login")  // ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€ URL
                .defaultSuccessUrl("/dashboard", true)  // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL
                .failureUrl("/login?error=true")  // ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL
                .permitAll()  // ë¡œê·¸ì¸ í˜ì´ì§€ëŠ” ëª¨ë“  ì‚¬ìš©ì ì ‘ê·¼ í—ˆìš©
            )
            
            // ë¡œê·¸ì•„ì›ƒ ì„¤ì •
            .logout(logout -> logout
                .logoutUrl("/logout")  // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ URL
                .logoutSuccessUrl("/login?logout=true")  // ë¡œê·¸ì•„ì›ƒ ì„±ê³µ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                .invalidateHttpSession(true)  // ì„¸ì…˜ ë¬´íš¨í™”
                .deleteCookies("JSESSIONID")  // ì„¸ì…˜ ì¿ í‚¤ ì‚­ì œ
                .permitAll()
            )
            
            //
